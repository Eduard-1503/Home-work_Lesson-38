ДЗ №25: Настраиваем бэкапы

Цель домашнего задания: Научиться настраивать VLAN и LACP.
Описание домашнего задания:
  Настроить стенд Vagrant:
  - с двумя виртуальными машинами Server-backup и Client;
  - настроить удаленный бэкап каталога /etc c Client-а при помощи borgbackup; 
  - резервные копии должны соответствовать следующим критериям:
    - директория для резервных копий /var/backup. Это должна быть отдельная точка монтирования, для демонстрации размер не принципиален, достаточно будет и 2GB;
    - репозиторий для резервных копий должен быть зашифрован ключом или паролем;
    - имя бэкапа должно содержать информацию о времени снятия бекапа;
    - глубина бекапа должна быть год, по последней копии на конец месяца, последние три месяца должны содержать копии на каждый день;
    - в целях демонстрации резервная копия снимается каждые 5 минут;
    - написан скрипт для снятия резервных копий, скрипт запускается либо Cron-ом, либо systemd timer-ом;
    - настроено логирование процесса бекапа, если настроите не в syslog, то обязательна ротация логов.

Для проверки представляю:
  - Vagrantfile разворачивающий два сервера Server-backup и Client;
  - playbook.yaml и файл-инветори hosts, с помощью которых производится доустановка необходимых пакетов и начальная конфигурация серверов;
  - borg-backup.sh для настройки и выполнения бэкапов и ротации лог-файлов Cron-ом;
  - файл лога выпонения бэкапа borg_backup-2023-06-08.log.

Процедура восстановления из бэкапа:
  1. Несмотря на то, что в ходе выполнения бэкапа производится проверка репозитория, выполню проверку копии из которой собираюсь восстанвливать каталог/файл
     пример:
     # borg check -v borg@192.168.56.9:/var/backup/Client::etc-2023-06-09_07:05:01 
     > Remote: Starting repository check
     > Remote: Starting repository index check
     > Remote: Index object count match.
     > Remote: Completed repository check, no problems found.
     > Starting archive consistency check...
     > Analyzing archive etc-2023-06-09_07:05:01 (1/1)
     > Orphaned objects check skipped (needs all archives checked).
     > Archive consistency check complete, no problems found.
     Наблюдаю сообщение, что в архиве пробле нет 
  2. Восстанавливаем каталог/файл
     предварительно можно посмотреть содержимое архива
     пример:
     # borg list borg@192.168.56.9:/var/backup/Client::etc-2023-06-09_07:05:01
     конкретный файл
     пример:
     # borg extract borg@192.168.56.9:/var/backup/Client::etc-2023-06-09_07:05:01 etc/grub2.cfg
     или весь архив
     пример:
     # borg extract borg@192.168.56.9:/var/backup/Client::etc-2023-06-09_07:05:01
  3. Каталог/файл будет воостановлен в текущий каталог из которого была выполнена команда из п.2 сохраняя все пути и права.

P.S.: 
  - для более упорядоченного хранения бэкапов репозиторий был создан в каталоге /var/backup/Client; 
  - для наглядности удаления старых бэкапов добавил правило хранить по 1-ой копии за два последних часа;
